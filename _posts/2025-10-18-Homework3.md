---
layout: post 
title: "Statistics Homework 3: RSA Encryption with White Nights" 
date: 2025-10-18
---

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

## Exploring RSA Encryption with White Nights

This homework dives into RSA encryption, a key cybersecurity technique, using White Nights and Other Stories by Fyodor Dostoyevsky. The text is huge (~516,363 letters), so I focused on a small snippet for RSA, as itâ€™s meant for short messages. I computed the letter distribution, encrypted a snippet with RSA, and tried decoding it, connecting stats to cryptanalysis. Below are the three parts: letter distribution, RSA encryption, and decryption, with tables and charts like my last homework.

### Part 1: Letter Distribution Analysis

I started by analyzing the letter distribution of White Nights and Other Stories, stored in nights.txt. This gives a baseline for English text frequencies, useful for checking decryption later.

Steps
  - Used nights.txt (~516,363 letters).
  - Wrote a Python script to count lowercase a-z letters, ignoring spaces, punctuation, and case.
  - Calculated percentages and made a table.
  - Created a Chart.js bar chart to visualize frequencies, similar to my last homework.

| letter | count  | percentage |
|--------|--------|------------|
| a      | 43002  | 8.33%      |
| b      | 7266   | 1.41%      |
| c      | 11394  | 2.21%      |
| d      | 22049  | 4.27%      |
| e      | 61152  | 11.84%     |
| f      | 11051  | 2.14%      |
| g      | 10999  | 2.13%      |
| h      | 30489  | 5.91%      |
| i      | 36797  | 7.13%      |
| j      | 593    | 0.11%      |
| k      | 4877   | 0.94%      |
| l      | 21636  | 4.19%      |
| m      | 14137  | 2.74%      |
| n      | 35977  | 6.97%      |
| o      | 40641  | 7.87%      |
| p      | 7949   | 1.54%      |
| q      | 445    | 0.09%      |
| r      | 27239  | 5.28%      |
| s      | 31379  | 6.08%      |
| t      | 47298  | 9.16%      |
| u      | 15853  | 3.07%      |
| v      | 6429   | 1.25%      |
| w      | 12851  | 2.49%      |
| x      | 741    | 0.14%      |
| y      | 13677  | 2.65%      |
| z      | 401    | 0.08%      |

#### Chart

<canvas id="originalChart" width="400" height="200"></canvas>
<script>
const ctxOriginal = document.getElementById('originalChart').getContext('2d');
const originalData = {
  labels: ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'],
  datasets: [{
    label: 'Letter Frequency (%)',
    data: [8.33, 1.41, 2.21, 4.27, 11.84, 2.14, 2.13, 5.91, 7.13, 0.11, 0.94, 4.19, 2.74, 6.97, 7.87, 1.54, 0.09, 5.28, 6.08, 9.16, 3.07, 1.25, 2.49, 0.14, 2.65, 0.08],
    backgroundColor: 'rgba(75, 192, 192, 0.2)',
    borderColor: 'rgba(75, 192, 192, 1)',
    borderWidth: 1
  }]
};
new Chart(ctxOriginal, { type: 'bar', data: originalData, options: { scales: { y: { beginAtZero: true } } } });
</script>

### Part 2: Encrypting with RSA

Since White Nights has ~516,363 letters, encrypting the whole text with RSA would take forever because RSA is for short messages. I picked the first 100 letters to encrypt, showing how RSA works in cybersecurity.

Steps:
  - Took the first 100 letters: firstnightitwasawonderfulnightsuchanightasisonlypossiblewhenweareyoungdearreadertheskywassostarry.
  - Converted letters to numbers (a=1, b=2, ..., z=26).
  - Used RSA with small primes (p=61, q=53, n=3233, e=17) to encrypt each number as ( c = m^{17} \mod 3233 ).
  - Made a table for the first 10 letters and a Chart.js bar chart for all 100 ciphertext numbers, styled like my last homework.


```python
import re

def rsa_encrypt(message, e, n):
    return [pow(ord(c) - ord('a') + 1, e, n) for c in message]

# Read text file
with open('nights.txt', 'r', encoding='utf-8') as file:
    text = file.read().lower()

# Get first 100 letters
letters = re.findall(r'[a-z]', text)[:100]
snippet = ''.join(letters)

# RSA parameters
p, q = 61, 53
n = p * q  # 3233
e = 17

# Encrypt
ciphertext = rsa_encrypt(snippet, e, n)

# Print table for first 10
print("| Letter | Number (m) | Ciphertext (c = m^17 mod 3233) |")
print("|--------|------------|-------------------------------|")
for i, (let, num, cip) in enumerate(zip(snippet[:10], [ord(c) - ord('a') + 1 for c in snippet[:10]], ciphertext[:10])):
    print(f"| {let} | {num} | {cip} |")

# Print ciphertext for chart
print("Ciphertext:", ciphertext)

```

#### Table

| Letter | Number (m) | Ciphertext (c = m^17 mod 3233) |
|---------|-------------|--------------------------------|
| f       | 6           | 1926                           |
| i       | 9           | 1289                           |
| r       | 18          | 2048                           |
| s       | 19          | 2583                           |
| t       | 20          | 1236                           |
| n       | 14          | 1222                           |
| i       | 9           | 1289                           |
| g       | 7           | 1551                           |
| h       | 8           | 3087                           |
| t       | 20          | 1236                           |


#### Chart

<canvas id="rsaChart" width="400" height="200"></canvas>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctxRSA = document.getElementById('rsaChart').getContext('2d');
const rsaData = {
  labels: ['f', 'i', 'r', 's', 't', 'n', 'i', 'g', 'h', 't'],
  datasets: [{
    label: 'Ciphertext (c = m^17 mod 3233)',
    data: [1926, 1289, 2048, 2583, 1236, 1222, 1289, 1551, 3087, 1236],
    backgroundColor: 'rgba(54, 162, 235, 0.2)',
    borderColor: 'rgba(54, 162, 235, 1)',
    borderWidth: 1
  }]
};
new Chart(ctxRSA, {
  type: 'bar',
  data: rsaData,
  options: {
    plugins: {
      title: {
        display: true,
        text: 'RSA Ciphertext Values (m^17 mod 3233)'
      }
    },
    scales: {
      y: { beginAtZero: true }
    }
  }
});
</script>

