---
layout: post
title: "Homework 11 - SDE Simulation (Brownian Motion)"
use_math: true
date: 2025-12-03
---

<script>
  MathJax = {
    tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
    svg: { fontCache: 'global' }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
    /* Dashboard Styling */
    .dashboard-container {
        font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        margin-top: 20px;
    }
    .controls-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 15px;
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #e9ecef;
        margin-bottom: 20px;
    }
    .control-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 5px;
        font-size: 0.9em;
        color: #495057;
    }
    .control-group input {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #ced4da;
        border-radius: 4px;
        font-size: 1em;
    }
    .btn-run {
        width: 100%;
        padding: 12px;
        background-color: #e67e22;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.2s;
        margin-bottom: 20px;
    }
    .btn-run:hover {
        background-color: #d35400;
    }
    .stats-panel {
        background-color: #2c3e50;
        color: #ecf0f1;
        padding: 20px;
        border-radius: 8px;
        font-family: 'Courier New', Courier, monospace;
        line-height: 1.5;
        margin-bottom: 30px;
    }
    .charts-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
    }
    .chart-box {
        flex: 1;
        min-width: 350px;
        background: white;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #e9ecef;
    }
</style>

## 1. Theoretical Background

In previous assignments (e.g., Homework 7), we explored discrete Random Walks. In this assignment, we use the **Eulerâ€“Maruyama method** to simulate the continuous limit of a random walk: the **Wiener Process** (or Brownian Motion).

A general Stochastic Differential Equation (SDE) is defined as:
$$
dX_t = \mu(X_t, t)dt + \sigma(X_t, t)dW_t
$$

For a standard Brownian Motion, the drift $\mu = 0$ and the diffusion $\sigma$ is constant. The Euler-Maruyama discretization for time step $dt$ is:
$$
W_{t+1} = W_t + \sigma \cdot \sqrt{dt} \cdot Z
$$
Where $Z \sim \mathcal{N}(0, 1)$. This simulation allows us to verify the theoretical properties:
$$E[W_T] = 0 \quad \text{and} \quad Var(W_T) = \sigma^2 T$$

---

## 2. SDE Simulator

<div class="dashboard-container">

    <div class="controls-grid">
        <div class="control-group">
            <label>1. Time Horizon (T)</label>
            <input type="number" id="inp_T" value="1" step="0.1">
        </div>
        <div class="control-group">
            <label>2. Time Steps (n)</label>
            <input type="number" id="inp_n" value="1000" step="100">
        </div>
        <div class="control-group">
            <label>3. Trajectories (N)</label>
            <input type="number" id="inp_N" value="500" step="50">
        </div>
        <div class="control-group">
            <label>4. Diffusion ($\sigma$)</label>
            <input type="number" id="inp_sigma" value="1" step="0.1">
        </div>
    </div>

    <button class="btn-run" onclick="runSimulation()">Run Euler-Maruyama Simulation</button>

    <div class="stats-panel" id="statsOutput">
        <em>Press "Run" to generate statistics.</em>
    </div>

    <div class="charts-container">
        <div class="chart-box">
            <canvas id="pathChart"></canvas>
        </div>
        <div class="chart-box">
            <canvas id="histChart"></canvas>
        </div>
    </div>

</div>

<script>
let pathChartInstance = null;
let histChartInstance = null;

// Helper: Box-Muller Transform (Gaussian Generator)
function randn_bm() {
    let u = 0, v = 0;
    while(u === 0) u = Math.random(); 
    while(v === 0) v = Math.random();
    return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );
}

function runSimulation() {
    const T = parseFloat(document.getElementById('inp_T').value);
    const n = parseInt(document.getElementById('inp_n').value);
    const numPaths = parseInt(document.getElementById('inp_N').value);
    const sigma = parseFloat(document.getElementById('inp_sigma').value);
    
    const dt = T / n;
    
    const allFinalPositions = [];
    const pathDatasets = [];
    const maxPathsToDraw = 50; 
    
    const timeLabels = [];
    for(let i=0; i<=n; i++) timeLabels.push((i * dt).toFixed(2));

    for (let p = 0; p < numPaths; p++) {
        let currentW = 0;
        const currentPath = [0];

        for (let i = 0; i < n; i++) {
            // --- EULER-MARUYAMA STEP ---
            // General form: X_new = X_old + drift*dt + diffusion*sqrt(dt)*Z
            // For Brownian Motion: drift=0, diffusion=sigma
            const dW = sigma * Math.sqrt(dt) * randn_bm();
            currentW += dW;
            
            if (p < maxPathsToDraw) currentPath.push(currentW);
        }

        allFinalPositions.push(currentW);

        if (p < maxPathsToDraw) {
            pathDatasets.push({
                label: `Path ${p}`,
                data: currentPath,
                borderColor: 'rgba(52, 152, 219, 0.4)',
                borderWidth: 1,
                pointRadius: 0,
                fill: false,
                tension: 0
            });
        }
    }

    // Statistics
    const mean = allFinalPositions.reduce((sum, val) => sum + val, 0) / numPaths;
    const variance = allFinalPositions.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / numPaths;
    const stdDev = Math.sqrt(variance);

    const theoVar = Math.pow(sigma, 2) * T;
    const theoStd = Math.sqrt(theoVar);

    const outputHTML = `
        <h4>Euler-Maruyama Analysis (t = ${T})</h4>
        <strong>Parameters:</strong> dt = ${dt.toFixed(5)}, N = ${numPaths} <br><br>
        <strong>Empirical Mean:</strong> ${mean.toFixed(4)} (Expected: 0.0000) <br>
        <strong>Empirical Variance:</strong> ${variance.toFixed(4)} (Expected: ${theoVar.toFixed(4)})
    `;
    document.getElementById('statsOutput').innerHTML = outputHTML;

    // Plotting Logic
    const ctxPath = document.getElementById('pathChart').getContext('2d');
    if (pathChartInstance) pathChartInstance.destroy();

    pathChartInstance = new Chart(ctxPath, {
        type: 'line',
        data: { labels: timeLabels, datasets: pathDatasets },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: false,
            plugins: { title: { display: true, text: `Wiener Process Paths` }, legend: { display: false } },
            scales: { x: { display: true, ticks: { maxTicksLimit: 8 } }, y: { display: true } }
        }
    });

    drawHistogram(allFinalPositions, 0, theoStd, T);
}

function drawHistogram(data, mean, std, T) {
    const ctxHist = document.getElementById('histChart').getContext('2d');
    if (histChartInstance) histChartInstance.destroy();

    const binCount = 30;
    const min = Math.min(...data);
    const max = Math.max(...data);
    const step = (max - min) / binCount;
    const bins = new Array(binCount).fill(0);
    const labels = [];
    
    for(let i=0; i<binCount; i++) labels.push((min + i*step + step/2).toFixed(2));

    data.forEach(val => {
        let idx = Math.floor((val - min) / step);
        if(idx >= binCount) idx = binCount - 1;
        bins[idx]++;
    });

    const scaleFactor = data.length * step;
    const normalCurve = labels.map(x => {
        return (1 / (std * Math.sqrt(2 * Math.PI))) * Math.exp(-0.5 * Math.pow((parseFloat(x) - mean) / std, 2)) * scaleFactor;
    });

    histChartInstance = new Chart(ctxHist, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [
                { label: 'Frequency', data: bins, backgroundColor: 'rgba(230, 126, 34, 0.7)' },
                { type: 'line', label: 'Theoretical Normal', data: normalCurve, borderColor: 'green', pointRadius: 0 }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { title: { display: true, text: `Distribution of W(${T})` } }
        }
    });
}

window.onload = runSimulation;
</script>

## 3. Conclusion

This simulation generalizes the concept of the discrete random walk (explored in Homework 7) into continuous time.

By utilizing the **Euler-Maruyama method** to simulate $N$ trajectories of the SDE $dW_t = \sigma dW_t$, we confirmed that the Wiener process follows a Normal distribution $\mathcal{N}(0, T)$. The convergence of the empirical mean to 0 and variance to $T$ validates the fundamental properties of Brownian motion.
