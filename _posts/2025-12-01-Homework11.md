---
layout: post
title: Homework 11 - Simulating and Analyzing Brownian Motion
use_math: true
date: 2025-12-01
---

<script>
  MathJax = {
    tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
    svg: { fontCache: 'global' }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

## Introduction

In this assignment, we simulate and analyze **Brownian Motion**, also known as the **Wiener Process**. Brownian motion is a continuous-time stochastic process $\{W_t\}_{t \geq 0}$ characterized by the following properties:

1. $W_0 = 0$.
2. It has independent increments: for every $t > s \geq 0$, $W_t - W_s$ is independent of the past values $W_u, u \leq s$.
3. It has Gaussian increments: $W_t - W_s \sim \mathcal{N}(0, t-s)$.
4. $W_t$ is continuous in $t$.

The process can be constructed as the limit of a scaled random walk. As the step size and time interval approach zero, the discrete random walk converges to Brownian motion.

### Mathematical Definition

For a small time step $dt$, the change in the process $dW$ is given by:
$$
dW = \varepsilon \sqrt{dt}
$$
where $\varepsilon \sim \mathcal{N}(0, 1)$ is a standard normal random variable.

The theoretical properties we aim to verify with our simulation are:
$$
E[W_t] = 0
$$
$$
Var(W_t) = t
$$

(Note: As a formatting example, the limit of a probability of no events in a Poisson interval is often written as $(1 - \lambda dt)^{t/dt} \to e^{-\lambda t}$, showing the connection between discrete steps and continuous time limits).

## Simulation

We will simulate $N$ paths of Brownian motion over a time interval $T$. We discretize the time into $k$ steps of size $dt$.

**Parameters:**
* $T$: Total time
* $dt$: Time step size
* $N$: Number of paths (simulations)

<div style="display: flex; flex-direction: column; align-items: center;">
    <canvas id="brownianChart" width="800" height="400"></canvas>
    <div id="stats-output" style="margin-top: 20px; font-family: monospace; background: #f4f4f4; padding: 10px; border-radius: 5px;"></div>
</div>

<script>
// Configuration
const T = 1.0;
const N = 100; // Time steps
const dt = T / N;
const numPaths = 50; // Number of trajectories to simulate

// Helper to generate random normal (Box-Muller transform)
function randn_bm() {
    let u = 0, v = 0;
    while(u === 0) u = Math.random(); 
    while(v === 0) v = Math.random();
    return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );
}

// Data structures
const timeLabels = [];
for (let i = 0; i <= N; i++) {
    timeLabels.push((i * dt).toFixed(2));
}

const datasets = [];
const finalValues = []; // To store W(T) for variance calc

// Generate Paths
for (let p = 0; p < numPaths; p++) {
    const data = [0]; // W_0 = 0
    let currentW = 0;
    
    for (let i = 1; i <= N; i++) {
        const dW = randn_bm() * Math.sqrt(dt);
        currentW += dW;
        data.push(currentW);
    }
    
    finalValues.push(currentW);
    
    datasets.push({
        label: `Path ${p+1}`,
        data: data,
        borderColor: `rgba(0, 123, 255, 0.3)`,
        borderWidth: 1,
        pointRadius: 0,
        fill: false
    });
}

// Calculate Statistics at T
const meanWT = finalValues.reduce((a, b) => a + b, 0) / numPaths;
const varWT = finalValues.reduce((a, b) => a + Math.pow(b - meanWT, 2), 0) / numPaths;

// Plotting
const ctx = document.getElementById('brownianChart').getContext('2d');
new Chart(ctx, {
    type: 'line',
    data: {
        labels: timeLabels,
        datasets: datasets
    },
    options: {
        responsive: true,
        plugins: {
            title: {
                display: true,
                text: `Brownian Motion Simulation (${numPaths} paths)`
            },
            legend: {
                display: false
            }
        },
        scales: {
            x: {
                title: { display: true, text: 'Time (t)' }
            },
            y: {
                title: { display: true, text: 'W(t)' }
            }
        }
    }
});

// Display Stats
const outputDiv = document.getElementById('stats-output');
outputDiv.innerHTML = `
    <strong>Analysis at t = ${T}:</strong><br>
    Theoretical Mean: 0 <br>
    Simulated Mean: ${meanWT.toFixed(4)} <br>
    <br>
    Theoretical Variance: ${T} <br>
    Simulated Variance: ${varWT.toFixed(4)}
`;
</script>

## Conclusion

The plot above shows **** $50$ realizations of a standard Brownian motion. As expected, all paths start at $0$ and spread out over time.

The numerical analysis at time $t=1$ shows that the empirical mean is close to the theoretical value of $0$, and the empirical variance is close to the theoretical value of $t=1$. This confirms that the diffusion of the particles follows the expected statistical laws of the Wiener process.
